<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Kaggle: Right Whale identification</title>

    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
	<link href="/css/blog.css" rel="stylesheet">
    <!-- Custom CSS -->
	<link href="/css/fifa.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="/js/jquery.js"></script>
	<script src="/js/d3.min.js"></script>
	<script src="/js/queue.v1.min.js"></script>
	<script src="/js/topojson.v1.min.js"></script>  
	<script src="/js/d3.tip.v0.6.3.js"></script>	
    <script src="/js/d3.fifa.js"></script>
	<!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script> 
	
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
<script>
$(document).ready(function(e) {
//	
SvgModule.init();
$(".tab").on("click", SvgModule.selectGraph);
$("#sort_by").on("change", SvgModule.selectGraph);
$("#play_button").on("click", SvgModule.playButtonHandler);
});
</script>

</head>
<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Home</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                
				<ul class="nav navbar-nav">
                    <li>
                        <a href="/portfolio.html">My projects</a>
                    </li>
				<!--
                    <li>
                        <a href="/links.html">Useful links</a>
                    </li>

					<li>
                        <a href="#">Interesting gists</a>
                    </li>
				-->
				</ul>

            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>
    <!-- Page Content -->
    <div class="container">



    
    
        
            
        
            
        
            
                
            
        
        
            
            
        
    



		<h2>Kaggle: Right Whale identification</h2>
		<p class="post_second_level_header">
			<span class="glyphicon glyphicon-calendar"></span>29 Dec 2015
			<span class="glyphicon glyphicon-comment"></span><a href="https://alexbra.github.io/2015/12/29/projects.whale-recognition/#disqus_thread" data-disqus-identifier="/2015/12/29/projects.whale-recognition/"></a>
			<span class="glyphicon glyphicon-folder-open"></span>nanodegree
			<span class="glyphicon glyphicon-tags"></span><i class="fa fa-tag"></i>: <a href="/blog/tag/machine-learning/"><span class="label label-info">machine-learning</span></a>
		</p>
		<hr>
		<div id="post_content" class="post-content">
		<p>I participated in a team of Udacity Data Analyst Nanodegree alumnies (DANDy Lions) to entry in Kaggle competition of identifying right whales.</p>

<h4 id="code-source-on-github">Code source on GitHub</h4>
<p><a href="https://github.com/alexbra/DAND-Right-Whale-Identification">https://github.com/alexbra/DAND-Right-Whale-Identification</a></p>

<h4 id="competitions-page">Competition’s page</h4>
<p><a href="https://www.kaggle.com/c/noaa-right-whale-recognition">https://www.kaggle.com/c/noaa-right-whale-recognition</a></p>

<h4 id="applied-technologies">Applied technologies</h4>

<p>Python, OpenCV, Sloth, AWS</p>

<h3 id="description">Description</h3>
<p>Fewer than 500 North Atlantic right whales left in the world’s oceans. There are more than 10000 aerial photos of them. The task is identify endangered right whales in aerial photographs.</p>

<p>We were divided in two teams by 4 people. One team wrote classifier to recognize whales on photos. Another one wrote whale’s identifier. 
I was in “recognizers” team. Thus, I accomplish the following tasks:</p>

<ul>
  <li>made annotations of photos by sloth and created positive and negative images</li>
  <li>built recognizer with OpenCV Cascade Classifier using AWS essentions</li>
  <li>created xml classifier</li>
</ul>

<h4 id="opencv-code">OpenCV code</h4>
<p><code>
opencv_createsamples -vec whale_faces.vec -num 4543 -info data.info -bg bg.txt -w 30 -h 30
opencv_traincascade -vec whale_faces.vec -w 30 -h 30 -data output/ -numPos 4000 -numNeg 6000 -bg bg.txt -numStages 12 -featureType LBP
</code></p>

<h4 id="python-code">Python code</h4>

<pre><code>import numpy as np
import cv2
from PIL import Image, ImageDraw
whale_cascade = cv2.CascadeClassifier('/home/alex/ml/whaleclassifier/whale_classifier.xml')
img = cv2.imread('/home/alex/ml/whaleclassifier/w_8488.jpg')
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
whales = whale_cascade.detectMultiScale(gray, 1.2, 7, 0, (280, 280))
imagefile = '/home/alex/ml/whaleclassifier/w_8488.jpg'
im = Image.open(imagefile)
dr = ImageDraw.Draw(im)
for (x,y,w,h) in whales:
    #we want our box outlines to be wider than a single pixel, so we use this loop
    outline_width = 4
    for i in range(outline_width):
	dr.rectangle(((x-i, y-i), (x+w+i, y+h+i)), outline = "red")
im.save('/home/alex/ml/whaleclassifier/outimage.jpg')
</code></pre>

<p>As a result, I’ve got a classifier and apply it in Python code. 
Here’s an example of recognizer’s work:
<img src="/img/whale_squared.jpg" alt="" /></p>

<p>Finally, our team obtained 117 place from 339</p>

<p>Despite on average result, I satisfied of it. I’ve learnt new technologies (such as Sloth, OpenCV, Github forked flow), 
became Ubuntu user, met interesting people (we had an international team) and collaborated as a team member.</p>


		</div>
<hr>
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * ADD YOUR DISQUS SHORTNAME HERE * * */
  var disqus_shortname = 'alexbrablog';
  
  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by  <span class="logo-disqus">Disqus</span></a>



        <hr>
	
        <!-- Footer -->
        <footer>
			
            <div class="row">
                <div class="col-lg-12">
						<a href="https://www.linkedin.com/profile/view?id=109443060"><span class="span_in"></span></a>
						<a href="https://github.com/alexbra"><span class="span_git"></span></a>
						<a href="skype:alex_bra_don?add"><span class="span_skype"></span></a>				
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
        </footer>
    </div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'alexbrablog'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
var s = document.createElement('script'); s.async = true;
s.type = 'text/javascript';
s.src = '//' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script> 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7282037-16', 'auto');
  ga('send', 'pageview');

</script>
</body>

